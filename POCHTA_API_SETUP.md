# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ credentials

–î–ª—è —Ä–∞–±–æ—Ç—ã API –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **–¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è**:

### 1. AccessToken (–¢–æ–∫–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- **–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å:** –ü–æ–ª–µ `api_key` –≤ —Ç–∞–±–ª–∏—Ü–µ `delivery_services`
- **–ß—Ç–æ —ç—Ç–æ:** –î–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:** –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: AccessToken <token>`
- **–ü—Ä–∏–º–µ—Ä:** `ty2372MFNCTRiqBF8OfmoBBuMh785Ldy`

### 2. Basic Auth Secret (Base64 –ª–æ–≥–∏–Ω:–ø–∞—Ä–æ–ª—å)
- **–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å:** –ü–æ–ª–µ `api_secret` –≤ —Ç–∞–±–ª–∏—Ü–µ `delivery_services`
- **–ß—Ç–æ —ç—Ç–æ:** Base64-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ `login:password` (–ë–ï–ó –ø—Ä–µ—Ñ–∏–∫—Å–∞ "Basic ")
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:** –ó–∞–≥–æ–ª–æ–≤–æ–∫ `X-User-Authorization: Basic <base64>`
- **–ü—Ä–∏–º–µ—Ä:** `Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE=`

## ‚ùå –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "Basic "
```sql
-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
api_secret = 'Basic Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE='

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
api_secret = 'Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE='
```

### –û—à–∏–±–∫–∞ 2: –ü–µ—Ä–µ–ø—É—Ç–∞–Ω—ã –º–µ—Å—Ç–∞–º–∏
```sql
-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
api_key = 'Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE='  -- –≠—Ç–æ Base64!
api_secret = 'ty2372MFNCTRiqBF8OfmoBBuMh785Ldy'  -- –≠—Ç–æ AccessToken!

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
api_key = 'ty2372MFNCTRiqBF8OfmoBBuMh785Ldy'  -- AccessToken
api_secret = 'Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE='  -- Base64
```

## üìù SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```sql
-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏
UPDATE delivery_services 
SET 
  -- AccessToken (—Ç–æ–∫–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
  api_key = '–í–ê–®_ACCESS_TOKEN_–ò–ó_–õ–ò–ß–ù–û–ì–û_–ö–ê–ë–ò–ù–ï–¢–ê',
  
  -- Base64(login:password) –ë–ï–ó –ø—Ä–µ—Ñ–∏–∫—Å–∞ "Basic "
  api_secret = '–í–ê–®–ê_BASE64_–°–¢–†–û–ö–ê_–ë–ï–ó_PREFIX_Basic',
  
  -- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ settings
  settings = jsonb_set(
    COALESCE(settings, '{}'::jsonb),
    '{api_token}',
    to_jsonb('–í–ê–®_ACCESS_TOKEN'::text)
  )
WHERE code = 'russian_post' AND is_active = true;
```

## üîç –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å Base64(login:password)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–Ω–ª–∞–π–Ω-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://www.base64encode.org/
2. –í–≤–µ–¥–∏—Ç–µ: `–≤–∞—à_–ª–æ–≥–∏–Ω:–≤–∞—à_–ø–∞—Ä–æ–ª—å` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `genii-881@yandex.ru:Baba409409329dada`)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ë–ï–ó –ø—Ä–µ—Ñ–∏–∫—Å–∞ "Basic ")

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ JavaScript –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12):
btoa('–≤–∞—à_–ª–æ–≥–∏–Ω:–≤–∞—à_–ø–∞—Ä–æ–ª—å')
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "Z2VuaWktODgxQHlhbmRleC5ydTpCYWJhNDA5NDAyOTMyOWRhZGE="
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Node.js
```javascript
Buffer.from('–≤–∞—à_–ª–æ–≥–∏–Ω:–≤–∞—à_–ø–∞—Ä–æ–ª—å').toString('base64')
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **AccessToken –≤ api_key:**
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (–æ–±—ã—á–Ω–æ 30+ —Å–∏–º–≤–æ–ª–æ–≤)
   - –ù–ï –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å Base64 —Å—Ç—Ä–æ–∫–æ–π

2. **Base64 –≤ api_secret:**
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å Base64 —Å—Ç—Ä–æ–∫–∞ (–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `=`)
   - –ù–ï –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å "Basic "
   - –ù–ï –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å AccessToken

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Üí –î–æ—Å—Ç–∞–≤–∫–∞ ‚Üí –°–ª—É–∂–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏
   - –ù–∞–π–¥–∏—Ç–µ "–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## üö® –û—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ 401: "Error token value not found"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π AccessToken –≤ `api_key`
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `api_key` —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –∏—Å—Ç–µ–∫ (–ø–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π –≤ –õ–ö –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏)

### –û—à–∏–±–∫–∞ 407: "Proxy Authentication Required"
**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `X-User-Authorization`
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `api_secret` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ Base64 —Å—Ç—Ä–æ–∫–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å–∞ "Basic " –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏

### –û—à–∏–±–∫–∞ 417: "–î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω"
**–ü—Ä–∏—á–∏–Ω–∞:** IP-–∞–¥—Ä–µ—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ü–æ—á—Ç—ã –†–æ—Å—Å–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è IP –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∏–¥–∂–µ—Ç –≤–º–µ—Å—Ç–æ API

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: https://otpravka.pochta.ru/specification
- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç: https://otpravka.pochta.ru
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: support@pochta.ru

