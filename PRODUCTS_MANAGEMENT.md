# Система управления товарами

## Реализованные функции

### 1. CRUD для товаров с фото
- ✅ Создание товара с загрузкой нескольких изображений
- ✅ Редактирование товара
- ✅ Удаление товара
- ✅ Просмотр списка товаров с изображениями
- ✅ Предпросмотр загруженных изображений
- ✅ Удаление изображений перед сохранением

### 2. Категории и подкатегории
- ✅ Выбор основной категории (Платки, Банданы, Капор, Косынки)
- ✅ Выбор подкатегории в зависимости от основной категории
- ✅ Модель Category с поддержкой иерархии (parentId)
- ✅ API endpoints для управления категориями

### 3. Вариации товаров
- ✅ Вариации по цвету и размеру
- ✅ Отдельные остатки для каждой вариации
- ✅ SKU для каждой вариации
- ✅ Управление вариациями в форме товара
- ✅ Отображение общего остатка и количества вариаций в таблице

### 4. Импорт/экспорт CSV
- ✅ Экспорт товаров в CSV формат
- ✅ Импорт товаров из CSV файла
- ✅ Парсинг CSV с автоматическим определением полей
- ✅ Поддержка кириллицы (UTF-8 BOM)

### 5. Остатки на складе
- ✅ Общий остаток товара
- ✅ Остатки по вариациям (цвет/размер)
- ✅ Статус "В наличии" / "Нет в наличии"
- ✅ Отображение остатков в таблице товаров
- ✅ Автоматический расчет общего остатка из вариаций

### 6. Оптовые цены и скидки
- ✅ Множественные ценовые диапазоны (от X до Y шт.)
- ✅ Гибкая система оптовых цен
- ✅ Процентная скидка на товар
- ✅ Отображение цен и скидок в таблице

## Структура данных

### Product (Товар)
```typescript
{
  id: string;
  name: string;
  category: 'scarves' | 'bandanas' | 'capor' | 'kosinka';
  subcategory?: string;
  description: string;
  image: string;
  images?: string[];
  priceRanges: PriceRange[];
  colors: string[];
  sizes: string[];
  material: string;
  sku?: string;
  stock?: number;
  variations?: ProductVariation[];
  discount?: number;
  inStock: boolean;
}
```

### ProductVariation (Вариация)
```typescript
{
  id?: string;
  color?: string;
  size?: string;
  sku?: string;
  stock: number;
  price?: number;
}
```

### Category (Категория)
```javascript
{
  name: string;
  slug: string;
  parentId?: ObjectId;
  description?: string;
  image?: string;
  order: number;
  isActive: boolean;
}
```

## Использование

### Форма редактирования товара

Форма включает все необходимые поля:
- Основная информация (название, описание, категория, подкатегория)
- Загрузка изображений (множественная)
- Цвета и размеры (динамическое добавление)
- Оптовые цены (несколько диапазонов)
- Скидки (процент)
- Остатки на складе (общий и по вариациям)

### Импорт/Экспорт CSV

#### Экспорт
1. Нажмите кнопку "Экспорт CSV"
2. Файл будет скачан с текущей датой в названии
3. Формат: UTF-8 с BOM для корректного отображения кириллицы

#### Импорт
1. Нажмите кнопку "Импорт CSV"
2. Выберите CSV файл
3. Файл будет автоматически распарсен
4. Товары будут созданы/обновлены

### Формат CSV

Заголовки:
- ID
- Название
- Категория
- Подкатегория
- Материал
- SKU
- Остаток
- Цена (мин)
- Цвета (разделитель: `;`)
- Размеры (разделитель: `;`)
- В наличии (Да/Нет)

## API Endpoints

### Товары
- `GET /admin/products` - Список товаров
- `GET /admin/products/:id` - Получить товар
- `POST /admin/products` - Создать товар (multipart/form-data)
- `PUT /admin/products/:id` - Обновить товар (multipart/form-data)
- `DELETE /admin/products/:id` - Удалить товар

### Импорт/Экспорт
- `GET /admin/products/export/csv` - Экспорт CSV
- `POST /admin/products/import/csv` - Импорт CSV

### Категории
- `GET /admin/categories` - Список категорий
- `POST /admin/categories` - Создать категорию
- `PUT /admin/categories/:id` - Обновить категорию
- `DELETE /admin/categories/:id` - Удалить категорию

## Следующие шаги

1. Подключить реальный API для загрузки изображений
2. Добавить валидацию форм (Zod)
3. Реализовать пагинацию для больших списков
4. Добавить фильтры по категориям и статусу
5. Добавить массовые операции (удаление, изменение статуса)
6. Реализовать поиск по всем полям
7. Добавить сортировку в таблице
8. Реализовать предпросмотр товара перед сохранением









